{
  "name": "Fellspiral Monorepo (Nix + Node)",
  "image": "mcr.microsoft.com/devcontainers/javascript-node:1-20-bookworm",
  "features": {
    "ghcr.io/devcontainers/features/nix:1": {
      "version": "latest",
      "multiUser": false,
      "extraNixConfig": "experimental-features = nix-command flakes\naccept-flake-config = true\nextra-substituters = https://cache.nixos.org https://nix-community.cachix.org\nextra-trusted-public-keys = cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY= nix-community.cachix.org-1:mB9FSh9qf2dCimDSUo8Zy7bkq5CX+/rkCWyvRCYg3Fs=\ntrusted-substituters = https://cache.nixos.org https://nix-community.cachix.org\ntrusted-public-keys = cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY= nix-community.cachix.org-1:mB9FSh9qf2dCimDSUo8Zy7bkq5CX+/rkCWyvRCYg3Fs=\ntrusted-users = root node\ndownload-buffer-size = 1073741824"
    }
  },
  "postCreateCommand": "nix develop --accept-flake-config --command echo 'Nix environment built' && npm install",
  "postStartCommand": "echo 'ðŸš€ Dev environment ready! Use \"nix develop\" to access gcloud, gh, terraform, etc.'",
  "forwardPorts": [3000],
  "portsAttributes": {
    "3000": {
      "label": "Dev Server",
      "onAutoForward": "notify"
    }
  },
  "customizations": {
    "vscode": {
      "extensions": ["jnoortheen.nix-ide", "bbenoist.Nix"],
      "settings": {
        "terminal.integrated.defaultProfile.linux": "nix-shell",
        "terminal.integrated.profiles.linux": {
          "bash": {
            "path": "/bin/bash"
          },
          "nix-shell": {
            "path": "/bin/bash",
            "args": ["-c", "nix develop --accept-flake-config --command bash"]
          }
        },
        "nix.enableLanguageServer": false
      }
    }
  },
  "containerEnv": {
    "NIXPKGS_ALLOW_UNFREE": "1"
  },
  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}"
}
