# tmux-tui configuration
# Auto-sourced by Nix shellHook when in tmux
# TMUX_TUI_SPAWN_SCRIPT environment variable is set by shellHook
#
# General tmux settings (terminal type, hyperlinks, passthrough) are now
# configured via Home Manager in nix/home/tmux.nix

# Hook: Auto-spawn TUI in new windows
set-hook -g after-new-window 'run-shell "TMUX_NEW_WINDOW_HOOK=1 $TMUX_TUI_SPAWN_SCRIPT"'

# Hook: Update pane focus file when pane/window selection changes
# Uses same namespace directory as alerts for fsnotify to detect
set-hook -g after-select-pane 'run-shell "mkdir -p /tmp/claude/$(basename #{socket_path}) && echo #{pane_id} > /tmp/claude/$(basename #{socket_path})/pane-focus"'
set-hook -g after-select-window 'run-shell "mkdir -p /tmp/claude/$(basename #{socket_path}) && echo #{pane_id} > /tmp/claude/$(basename #{socket_path})/pane-focus"'

# Keybinding: Ctrl+Space to reopen TUI
bind-key -n C-Space run-shell "$TMUX_TUI_SPAWN_SCRIPT"

# Keybinding: Prefix + B (capital B) to toggle block state
bind B run-shell "TMUX_PANE=#{pane_id} $TMUX_TUI_INSTALL_DIR/tmux-tui-block"
